<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Open Inventory</title>
    <script src="https://unpkg.com/@owlbear-rodeo/sdk@2/lib/umd/index.js"></script>
    <style>
        body { margin: 0; overflow: hidden; }
        .container {
            display: flex;
            justify-content: center;
            align-items: center;
            width: 170px;
            height: 60px;
            background-color: #1a1a2e;
        }
        button {
            width: 150px;
            height: 40px;
            background-color: #e94560;
            color: white;
            border: none;
            border-radius: 5px;
            font-size: 14px;
            cursor: pointer;
            font-weight: bold;
        }
        button:hover { background-color: #f0627b; }
    </style>
</head>
<body>
    <svg id="icon" style="display: none;" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="white">
      <path d="M20,6H17.82A4.23,4.23,0,0,0,14,2.18V2a2,2,0,0,0-4,0v.18A4.23,4.23,0,0,0,6.18,6H4A2,2,0,0,0,2,8V20a2,2,0,0,0,2,2H20a2,2,0,0,0,2-2V8A2,2,0,0,0,20,6ZM12,4a2.24,2.24,0,0,1,2,1.8V6H10V5.8A2.24,2.24,0,0,1,12,4ZM20,20H4V8H20Z"/>
    </svg>

    <div class="container">
        <button id="open-inventory">Open Inventory</button>
    </div>

    <script>
        function main() {
            console.log("Step 1: main() function has started.");

            OBR.onReady(() => {
                console.log("Step 2: OBR.onReady() callback has fired.");

                OBR.popover.setHeight(60);
                OBR.popover.setWidth(170);
                console.log("Step 3: Popover dimensions have been set.");

                const button = document.getElementById("open-inventory");
                console.log("Step 4: Searched for button. Result:", button);

                if (button) {
                    console.log("Step 5: Button was found! Attaching .onclick handler.");
                    button.onclick = () => {
                        console.log("Step 6: SUCCESS! The .onclick handler has fired!");
                        button.textContent = "Clicked!";
                        OBR.modal.open({
                            id: "com.example.inventory/modal",
                            url: "https://zevankai.github.io/OwlBearInventory/inventory.html",
                            width: 800,
                            height: 700
                        });
                    };
                } else {
                    console.error("CRITICAL FAILURE: Button with id 'open-inventory' was NOT found.");
                }
            });
        }
        
        function initialize() {
            if (window.OBR) {
                main();
            } else {
                setTimeout(initialize, 100);
            }
        }
        window.addEventListener('load', initialize);
    </script>
</body>
</html>
